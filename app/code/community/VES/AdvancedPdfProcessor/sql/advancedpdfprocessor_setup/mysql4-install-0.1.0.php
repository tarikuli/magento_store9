<?php

$installer = $this;

$installer->startSetup();

try{
	$installer->run("
	ALTER TABLE `{$this->getTable('pdfpro/key')}` ADD `logo` VARCHAR( 255 ) NOT NULL AFTER `api_key`;
	");
}catch(Exception $e){
	
}

$installer->run("
ALTER TABLE `{$this->getTable('pdfpro/key')}` 
ADD `css` TEXT NULL AFTER `logo` ,
ADD `order_template` TEXT NOT NULL AFTER `css`,
ADD `invoice_template` TEXT NOT NULL AFTER `order_template` ,
ADD `shipment_template` TEXT NOT NULL AFTER `invoice_template`,
ADD `creditmemo_template` TEXT NOT NULL AFTER `shipment_template`,
ADD `template_id` int not null after `creditmemo_template`;

DROP TABLE IF EXISTS {$this->getTable('advancedpdfprocessor/template')};
CREATE TABLE {$this->getTable('advancedpdfprocessor/template')} (
`id` int(11) unsigned NOT NULL auto_increment,
`name` varchar(255) NOT NULL,
`sku` varchar(255) NOT NULL default '',
`css_path` varchar(255) NOT NULL default '',
PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


");
$data = array(
	'name'					=> 'Free001',
	'sku'					=> 'easypdf-free-001',
	'css_path'				=> 'ves_pdfpros/invoice_template/free-001/invoice.css',
	'order_template'		=> '<div class=\"logo-container\">{{var MY_LOGO}}</div>\n<div class=\"invoice-header\">\n	Order #{{var order.increment_id}}<br />\n	{{var order.created_at_formated.medium}}\n</div>\n\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Billing Address</h3>\n			{{var order.billing.formated}}\n		</td>\n		<td>\n			{{if order.shipping}}\n				<h3>Shipping Address</h3>\n				{{var order.shipping.formated}}\n			{{else}}\n				<h3>Payment Information</h3>\n				{{var order.payment_info}}\n			{{/if}}\n		</td>\n	</tr>\n</table>\n{{if order.shipping}}\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Payment Information</h3>\n			{{var order.payment_info}}\n		</td>\n		<td>\n			<h3>Shipping information</h3>\n			{{var order.shipping_description}}\n		</td>\n	</tr>\n</table>\n{{/if}}\n\n{{widget type=\"easypdf\" header_font_family=\"san-serif\" header_font_size=\"12\" row_font_family=\"san-serif\" row_font_size=\"12\" column=\"YTo2OntpOjA7YTo1OntzOjY6Im9wdGlvbiI7czo0OiJuYW1lIjtzOjU6InRpdGxlIjtzOjc6IlByb2R1Y3QiO3M6NToid2lkdGgiO3M6MzoiMTk1IjtzOjk6InNvcnRvcmRlciI7czoxOiIxIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjE7YTo1OntzOjY6Im9wdGlvbiI7czozOiJza3UiO3M6NToidGl0bGUiO3M6MzoiU2t1IjtzOjU6IndpZHRoIjtzOjI6IjgwIjtzOjk6InNvcnRvcmRlciI7czoxOiIyIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjI7YTo1OntzOjY6Im9wdGlvbiI7czozOiJxdHkiO3M6NToidGl0bGUiO3M6MzoiUXR5IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiIzIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjM7YTo1OntzOjY6Im9wdGlvbiI7czo1OiJwcmljZSI7czo1OiJ0aXRsZSI7czo1OiJQcmljZSI7czo1OiJ3aWR0aCI7czoyOiI0NSI7czo5OiJzb3J0b3JkZXIiO3M6MToiNCI7czo2OiJkZWxldGUiO3M6MDoiIjt9aTo0O2E6NTp7czo2OiJvcHRpb24iO3M6MTA6InRheF9hbW91bnQiO3M6NToidGl0bGUiO3M6MzoiVGF4IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiI1IjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjU7YTo1OntzOjY6Im9wdGlvbiI7czo5OiJyb3dfdG90YWwiO3M6NToidGl0bGUiO3M6NToiVG90YWwiO3M6NToid2lkdGgiO3M6MjoiODAiO3M6OToic29ydG9yZGVyIjtzOjE6IjYiO3M6NjoiZGVsZXRlIjtzOjA6IiI7fX0=\"}}\n\n<table class=\"totals\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n	<tr>\n		<td>&nbsp;</td>\n		<td class=\"total-due\">\n			<table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n				<tbody>\n					<tr class=\"subtotal_incl_tax\"><td>Subtotal:</td>\n						<td>{{var order.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"subtotal_excl_tax\"><td>Subtotal:</td>\n						<td>{{var order.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Excl. Tax):</td>\n						<td>{{var order.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Incl. Tax):</td>\n						<td>{{var order.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"discount\"><td>Discount:</td>\n						<td>{{var order.discount_amount}}</td>\n					</tr>\n					<tr class=\"shipping_excl_tax\"><td>Shipping:</td>\n						<td>{{var order.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_incl_tax\"><td>Shipping:</td>\n						<td>{{var order.shipping_incl_tax}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Excl. Tax):</td>\n						<td>{{var order.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Incl. Tax):</td>\n						<td>{{var order.shipping_incl_tax}}</td>\n					</tr>\n					<tr><td>Tax:</td>\n						<td>{{var order.tax_amount}}</td>\n					</tr>\n				</tbody>\n				<tfoot>\n					<tr class=\"grand tax_with_grand_total\"><td>Grand Total (Excl. Tax):</td>\n						<td>{{var order.grand_total_excl_tax}}</td>\n					</tr>\n					<tr class=\"grand tax_with_grand_total\"><td>Grand Total (Incl. Tax):</td>\n						<td>{{var order.grand_total}}</td>\n					</tr>\n					<tr class=\"grand grand_total\"><td>Grand Total:</td>\n						<td>{{var order.grand_total}}</td>\n					</tr>\n				</tfoot>\n			</table>\n		</td>\n	</tr>\n</table>',
	'invoice_template'		=> '<div class=\"logo-container\">{{var MY_LOGO}}</div>\n<div class=\"invoice-header\">\n	Invoice #{{var invoice.increment_id}}<br />\n	Order #{{var order.increment_id}}<br />\n	Order Date: {{var order.created_at_formated.medium}}\n</div>\n\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Billing Address</h3>\n			{{var invoice.billing.formated}}\n		</td>\n		<td>\n			{{if invoice.shipping}}\n				<h3>Shipping Address</h3>\n				{{var invoice.shipping.formated}}\n			{{else}}\n				<h3>Payment Information</h3>\n				{{var invoice.payment_info}}\n			{{/if}}\n		</td>\n	</tr>\n</table>\n{{if invoice.shipping}}\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Payment Information</h3>\n			{{var invoice.payment_info}}\n		</td>\n		<td>\n			<h3>Shipping information</h3>\n			{{var invoice.shipping_description}}\n		</td>\n	</tr>\n</table>\n{{/if}}\n\n{{widget type=\"easypdf\" header_font_family=\"san-serif\" header_font_size=\"12\" row_font_family=\"san-serif\" row_font_size=\"12\" column=\"YTo2OntpOjA7YTo1OntzOjY6Im9wdGlvbiI7czo0OiJuYW1lIjtzOjU6InRpdGxlIjtzOjc6IlByb2R1Y3QiO3M6NToid2lkdGgiO3M6MzoiMTk1IjtzOjk6InNvcnRvcmRlciI7czoxOiIxIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjE7YTo1OntzOjY6Im9wdGlvbiI7czozOiJza3UiO3M6NToidGl0bGUiO3M6MzoiU2t1IjtzOjU6IndpZHRoIjtzOjI6IjgwIjtzOjk6InNvcnRvcmRlciI7czoxOiIyIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjI7YTo1OntzOjY6Im9wdGlvbiI7czozOiJxdHkiO3M6NToidGl0bGUiO3M6MzoiUXR5IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiIzIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjM7YTo1OntzOjY6Im9wdGlvbiI7czo1OiJwcmljZSI7czo1OiJ0aXRsZSI7czo1OiJQcmljZSI7czo1OiJ3aWR0aCI7czoyOiI0NSI7czo5OiJzb3J0b3JkZXIiO3M6MToiNCI7czo2OiJkZWxldGUiO3M6MDoiIjt9aTo0O2E6NTp7czo2OiJvcHRpb24iO3M6MTA6InRheF9hbW91bnQiO3M6NToidGl0bGUiO3M6MzoiVGF4IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiI1IjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjU7YTo1OntzOjY6Im9wdGlvbiI7czo5OiJyb3dfdG90YWwiO3M6NToidGl0bGUiO3M6NToiVG90YWwiO3M6NToid2lkdGgiO3M6MjoiODAiO3M6OToic29ydG9yZGVyIjtzOjE6IjYiO3M6NjoiZGVsZXRlIjtzOjA6IiI7fX0=\"}}\n\n<table class=\"totals\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n	<tr>\n		<td>&nbsp;</td>\n		<td class=\"total-due\">\n			<table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n				<tbody>\n					<tr class=\"subtotal_incl_tax\"><td>Subtotal:</td>\n						<td>{{var invoice.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"subtotal_excl_tax\"><td>Subtotal:</td>\n						<td>{{var invoice.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Excl. Tax):</td>\n						<td>{{var invoice.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Incl. Tax):</td>\n						<td>{{var invoice.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"discount\"><td>Discount:</td>\n						<td>{{var invoice.discount_amount}}</td>\n					</tr>\n					<tr class=\"shipping_excl_tax\"><td>Shipping:</td>\n						<td>{{var invoice.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_incl_tax\"><td>Shipping:</td>\n						<td>{{var invoice.shipping_incl_tax}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Excl. Tax):</td>\n						<td>{{var invoice.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Incl. Tax):</td>\n						<td>{{var invoice.shipping_incl_tax}}</td>\n					</tr>\n					<tr><td>Tax:</td>\n						<td>{{var invoice.tax_amount}}</td>\n					</tr>\n				</tbody>\n				<tfoot>\n					<tr class=\"grand tax_with_grand_total\"><td>Grand Total (Excl. Tax):</td>\n						<td>{{var invoice.grand_total_excl_tax}}</td>\n					</tr>\n					<tr class=\"grand tax_with_grand_total\"><td>Grand Total (Incl. Tax):</td>\n						<td>{{var invoice.grand_total}}</td>\n					</tr>\n					<tr class=\"grand grand_total\"><td>Grand Total:</td>\n						<td>{{var invoice.grand_total}}</td>\n					</tr>\n				</tfoot>\n			</table>\n		</td>\n	</tr>\n</table>\n	\n	',
	'shipment_template'		=> '<div class=\"logo-container\">{{var MY_LOGO}}</div>\n<div class=\"invoice-header\">\n	Packingslip #{{var shipment.increment_id}}<br />\n	Order #{{var order.increment_id}}<br />\n	Order Date: {{var order.created_at_formated.medium}}\n</div>\n\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Billing Address</h3>\n			{{var shipment.billing.formated}}\n		</td>\n		<td>\n			{{if shipment.shipping}}\n				<h3>Shipping Address</h3>\n				{{var shipment.shipping.formated}}\n			{{else}}\n				<h3>Payment Information</h3>\n				{{var shipment.payment_info}}\n			{{/if}}\n		</td>\n	</tr>\n</table>\n{{if shipment.shipping}}\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Payment Information</h3>\n			{{var shipment.payment_info}}\n		</td>\n		<td>\n			<h3>Shipping information</h3>\n			{{var shipment.shipping_description}}\n		</td>\n	</tr>\n</table>\n{{/if}}\n\n{{widget type=\"easypdf\" header_font_family=\"san-serif\" header_font_size=\"12\" row_font_family=\"san-serif\" row_font_size=\"12\" column=\"YTozOntpOjA7YTo1OntzOjY6Im9wdGlvbiI7czozOiJxdHkiO3M6NToidGl0bGUiO3M6MzoiUXR5IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiIxIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjE7YTo1OntzOjY6Im9wdGlvbiI7czo0OiJuYW1lIjtzOjU6InRpdGxlIjtzOjc6IlByb2R1Y3QiO3M6NToid2lkdGgiO3M6MzoiMTk1IjtzOjk6InNvcnRvcmRlciI7czoxOiIyIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjI7YTo1OntzOjY6Im9wdGlvbiI7czozOiJza3UiO3M6NToidGl0bGUiO3M6MzoiU2t1IjtzOjU6IndpZHRoIjtzOjI6IjgwIjtzOjk6InNvcnRvcmRlciI7czoxOiIzIjtzOjY6ImRlbGV0ZSI7czowOiIiO319\"}}\n	\n	',
	'creditmemo_template'	=> '\n	\n	<div class=\"logo-container\">{{var MY_LOGO}}</div>\n<div class=\"invoice-header\">\n	Credit Memo #{{var creditmemo.increment_id}}<br />\n	Order #{{var order.increment_id}}<br />\n	Order Date: {{var order.created_at_formated.medium}}\n</div>\n\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Billing Address</h3>\n			{{var creditmemo.billing.formated}}\n		</td>\n		<td>\n			{{if creditmemo.shipping}}\n				<h3>Shipping Address</h3>\n				{{var creditmemo.shipping.formated}}\n			{{else}}\n				<h3>Payment Information</h3>\n				{{var creditmemo.payment_info}}\n			{{/if}}\n		</td>\n	</tr>\n</table>\n{{if creditmemo.shipping}}\n<table class=\"tbl-info\" cellspacing=\"0\" cellpadding=\"0\">\n	<tr valign=\"top\">\n		<td>\n			<h3>Payment Information</h3>\n			{{var creditmemo.payment_info}}\n		</td>\n		<td>\n			<h3>Shipping information</h3>\n			{{var creditmemo.shipping_description}}\n		</td>\n	</tr>\n</table>\n{{/if}}\n\n{{widget type=\"easypdf\" header_font_family=\"san-serif\" header_font_size=\"12\" row_font_family=\"san-serif\" row_font_size=\"12\" column=\"YTo2OntpOjA7YTo1OntzOjY6Im9wdGlvbiI7czo0OiJuYW1lIjtzOjU6InRpdGxlIjtzOjc6IlByb2R1Y3QiO3M6NToid2lkdGgiO3M6MzoiMTk1IjtzOjk6InNvcnRvcmRlciI7czoxOiIxIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjE7YTo1OntzOjY6Im9wdGlvbiI7czozOiJza3UiO3M6NToidGl0bGUiO3M6MzoiU2t1IjtzOjU6IndpZHRoIjtzOjI6IjgwIjtzOjk6InNvcnRvcmRlciI7czoxOiIyIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjI7YTo1OntzOjY6Im9wdGlvbiI7czozOiJxdHkiO3M6NToidGl0bGUiO3M6MzoiUXR5IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiIzIjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjM7YTo1OntzOjY6Im9wdGlvbiI7czo1OiJwcmljZSI7czo1OiJ0aXRsZSI7czo1OiJQcmljZSI7czo1OiJ3aWR0aCI7czoyOiI0NSI7czo5OiJzb3J0b3JkZXIiO3M6MToiNCI7czo2OiJkZWxldGUiO3M6MDoiIjt9aTo0O2E6NTp7czo2OiJvcHRpb24iO3M6MTA6InRheF9hbW91bnQiO3M6NToidGl0bGUiO3M6MzoiVGF4IjtzOjU6IndpZHRoIjtzOjI6IjQwIjtzOjk6InNvcnRvcmRlciI7czoxOiI1IjtzOjY6ImRlbGV0ZSI7czowOiIiO31pOjU7YTo1OntzOjY6Im9wdGlvbiI7czo5OiJyb3dfdG90YWwiO3M6NToidGl0bGUiO3M6NToiVG90YWwiO3M6NToid2lkdGgiO3M6MjoiODAiO3M6OToic29ydG9yZGVyIjtzOjE6IjYiO3M6NjoiZGVsZXRlIjtzOjA6IiI7fX0=\"}}\n\n<table class=\"totals\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n	<tr>\n		<td>&nbsp;</td>\n		<td class=\"total-due\">\n			<table cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n				<tbody>\n					<tr class=\"subtotal_incl_tax\"><td>Subtotal:</td>\n						<td>{{var creditmemo.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"subtotal_excl_tax\"><td>Subtotal:</td>\n						<td>{{var creditmemo.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Excl. Tax):</td>\n						<td>{{var creditmemo.subtotal}}</td>\n					</tr>\n					<tr class=\"subtotal_both\"><td>Subtotal (Incl. Tax):</td>\n						<td>{{var creditmemo.subtotal_incl_tax}}</td>\n					</tr>\n					<tr class=\"discount\"><td>Discount:</td>\n						<td>{{var creditmemo.discount_amount}}</td>\n					</tr>\n					<tr class=\"adjustment_positive\"><td>Adjustment Refund:</td>\n						<td>{{var creditmemo.adjustment_positive}}</td>\n					</tr>\n					<tr class=\"adjustment_negative\"><td>Adjustment Fee:</td>\n						<td>{{var creditmemo.adjustment_negative}}</td>\n					</tr>\n					<tr class=\"shipping_excl_tax\"><td>Shipping:</td>\n						<td>{{var creditmemo.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_incl_tax\"><td>Shipping:</td>\n						<td>{{var creditmemo.shipping_incl_tax}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Excl. Tax):</td>\n						<td>{{var creditmemo.shipping_amount}}</td>\n					</tr>\n					<tr class=\"shipping_both\"><td>Shipping (Incl. Tax):</td>\n						<td>{{var creditmemo.shipping_incl_tax}}</td>\n					</tr>\n					<tr class=\"tax\"><td>Tax:</td>\n						<td>{{var creditmemo.tax_amount}}</td>\n					</tr>\n				</tbody>\n				<tfoot>\n					<tr class=\"tax_with_grand_total\"><td>Grand Total (Excl. Tax):</td>\n						<td>{{var creditmemo.grand_total_excl_tax}}</td>\n					</tr>\n					<tr class=\"tax_with_grand_total\"><td>Grand Total (Incl. Tax):</td>\n						<td>{{var creditmemo.grand_total}}</td>\n					</tr>\n					<tr class=\"grand_total\"><td>Grand Total:</td>\n						<td>{{var creditmemo.grand_total}}</td>\n					</tr>\n				</tfoot>\n			</table>\n		</td>\n	</tr>\n</table>\n	\n	',
);
Mage::getModel('advancedpdfprocessor/template')->setData($data)->save();
$installer->endSetup();